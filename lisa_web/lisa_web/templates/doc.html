{% extends "bootstrap/base.html" %}
{% import "bootstrap/fixes.html" as fixes %}
{% import "bootstrap/wtf.html" as wtf %}
{% block head %}{{super()}}{{fixes.ie8()}}{% endblock %}
{% block html_attribs %} lang="en"{% endblock %}
{% block metas %}
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
{% endblock %}

{% block title %}LISA{% endblock %}

{% block navbar %}
<nav class="navbar fixed-top navbar-expand-lg navbar-dark">
  <div class="container">
    <a href="/" class="navbar-brand">
      <img src="/static/lisa.jpg" height="55" width="40" alt="lisa">
      <span></span>LISA
    </a>
    <div id="navbar-nav-scroll">
      <ul class="navbar-nav bd-navbar-nav flex-row">
        <li class="nav-item active">
          <a class="nav-link nav-a" href="http://lisa.cistrome.org/">HOME</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link nav-a" href="http://lisa.cistrome.org/lisa_gallery">Human Gallery</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link nav-a" href="http://lisa.cistrome.org/lisa_gallery_mm">Mouse Gallery</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link nav-a" href="http://lisa.cistrome.org/doc">Documentation</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
{% endblock %}

{% block styles %}
<!-- <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous"> -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

<link rel="stylesheet" href="{{ url_for('.static', filename='lisa.css') }}">
{% endblock %}

{% block content %}
<!--
<div class="row body2">
   <div class="col-sm-12">
<div class="jumbotron jumbotron-fluid shadow-sm">
  <div class="container">
    <h1 class="display-4"><b><abbr title="Large scale In Silico Analysis">LISA</abbr></b> documentation</h1>
  </div>
</div>
  </div>
</div>
-->

<div class="row">
<div class="col-sm-3 body">
<nav id="navbar-example" class="navbar navbar-light bg-light">
  <nav class="nav nav-pills flex-column">
    <a class="nav-link" href="#item-0">About</a>
    <nav class="nav nav-pills flex-column">
        <a class="nav-link" href="#item-1">Website version</a>
        <nav class="nav nav-pills flex-column">
          <a class="nav-link ml-3 my-1" href="#item-1-1">Website Usage</a>
          <a class="nav-link ml-3 my-1" href="#item-1-2">Website Output</a>
        </nav>
    </nav>
    <nav class="nav nav-pills flex-column">
        <a class="nav-link" href="#item-2">Local command version</a>
        <nav class="nav nav-pills flex-column">
          <a class="nav-link ml-3 my-1" href="#item-2-1">Local Installation</a>
          <a class="nav-link ml-3 my-1" href="#item-2-2">Local Usage</a>
          <a class="nav-link ml-3 my-1" href="#item-2-3">Local Output</a>
        </nav>
    </nav>
    <a class="nav-link" href="#item-3">FAQ</a>
  </nav>
</nav>
</div>

<div class="col-sm-8 body3">
<div data-target="#navbar-example" data-offset="0">
  <h4 id="item-0">About</h4>
  <p class="just">LISA is short for epigenetic Landscape In silico Subtraction analysis. LISA is a computational biology method that uses chromatin data from a comprehensive database of human and mouse DNase-seq, and H3K27ac ChIP-seq profiles, to determine the transcription factors and chromatin regulators that are directly responsible for the perturbation of a differentially expressed gene set. To run LISA online, the only thing you need is the differential gene set derived from differential gene expresion analysis for microarray and RNA-seq. Then you will be able to leverage the power of the most comprehensive DNase-seq, ATAC-seq and ChIP-seq database (<a href="http://cistrome.org/db/">CistromeDB</a>) to discover the underlying regulatory mechanisms, reveal the key transcription factors and chromatin regulators.</p>
  </p>
  </hr>

  <p class="just">First, LISA will build a chromatin landscape model using the input gene set based on the comprehensive database of DNase-seq, or histone modification profiles. The model selects a subset of the cell type specific chromatin landscape. Then, for each gene, LISA will probe the effect of transcription factors in these landscapes by simulating deletions of their binding sites. The binding sites could come from the ChIP-seq data in CistromeDB or the motif hit profile. Finally, LISA would assign every binding site profile(ChIP-seq data or motif hit profile) a score showing essentiality of the set of transcriptional regulator binding sites by evaluating the effect across all the input genes.</p>
  </hr>
</div>

  <h4 id="item-1">Website version</h4>
  <h5 id="item-1-1">Website Usage</h5>
  <p class="just">The input fields and options is shown in the input interface(Figure 1). User can input one or two gene set by using RefSeq ids or gene official symbols, usually the two gene sets can be obtained from up and down-regulated gene set from differential gene expression analysis,and select the species the gene set originates from. If one gene set is given, it should be placed in "Gene Set 1", and the TF ranking list of that one gene list would be provided. If two are given, an additional figure of comparison between the two gene set analysis will be generated, a typical scenario would be input up and down regulated gene set from a set of expression profiles, the label for each gene set can be customized optionally. For gene set size, we would recommend 50 to 500 genes, since few genes will lower the predictive power of chromatin profile modelling. To build a model that can best represent the cell type specific chromatin landscape, the number of genes can not be too few. However, because in-silico deleting binding sites are time-consuming step for all the ChIP-seq profile and motif hit profile for all the input genes, the LISA running time would suffer from the number of genes when it goes beyond 500. There are DNase-seq, and H3K27ac ChIP-seq profiles for us to choose. From the set of transcription factor perturbation experiments used as benchmarks in the paper (see in <a href="http://lisa.cistrome.org/lisa_gallery">Human</a>/<a href="http://lisa.cistrome.org/lisa_gallery_mm">Mouse</a> Gallery), we found that DNase-seq and H3K27ac are generally better than other chromatin profile, use can choose either to explore their gene set. User can select method based on TF ChIP-seq peak, based on in-silico knockout method, or both. A single run takes 5-10 minutes depending on the size of the gene set, user can optionally set an email to receive the result link.</p>
  </hr>

  <div class="figure1" id="id1" align="center">
  <img src="http://cistrome.org/~qqin/1.png" height="380" width="400">
  </div>
  <div align="center">Figure 1. LISA input interface</div>
  </hr>

  <h5 id="item-1-2">Website Output</h5>
  <p class="just">LISA output several results about TF ranking, if two gene sets are given, the output is as follows:</p>
  <li>a pairwise scatterplot for comparison of the two gene set TF rankings based on LISA cis-elements knockout method (Figure 2).</li>
  <li>a pairwise scatterplot for comparison of the two gene set based on TF ChIP-seq peak regulatory potential (Figure 3). </li>
  <p class="just">NOTE: These two figures can be saved to local disk, The x axis and y axis shows the -log10(p-value) of the TF ranking significance for either gene set. Once user mouse over the points, the corresponding TF ChIP-seq sample will be shown by Cistrome ID and TF name, user can see details information about the sample by searching CistromeDB with Cistrome ID.</p>

  <li>The TF ranking table of the LISA cis-elements knockout method based on ChIP-seq(Figure 4). </li>
  <li>The TF ranking table of the TF ranking from TF ChIP-seq peak(Figure 5). </li>
  <li>Selected chromatin profile and model performance. The annotation and the coefficient of the selected chromatin profile is selected (Figure 6). Along with the table, there is a ROCAUC curve to show the model performance.</li>

  <p class="just">NOTE: Click on each of the p-value for TF ranking or each sample for chromatin profile, the Cistrome dataset link will be shown below (Figure 5).</p>
  <li>The ranking table for Motif PWM based TF ranking (Figure 6).</li>
  <p class="just">NOTE: These tables above can be exported to csv or pdf to local disk. </p>

  <li>WashU genome browser for gene set enrichment.We randomly picked arbitrarily 20 genes from the differential gene set to generate the genome tracks for the top ranked TF ChIP-seq, selected chromatin profile ChIP-seq for both gene set 1 (e.g. up regulated) and gene set 2 (e.g. down regulated) gene set (Figure 8).</li>
  
  <p class="just"></p>
  </hr>

  <div class="figure1" align="center">
  <img alt="_images/2.png" src="http://cistrome.org/~qqin/2.png" height="500" width="650">
  </div>
  <div align="center">Figure 2. demo for LISA ranking of TF comparion between gene sets by in-silico knockout method</div>

  <div class="figure1" align="center">
  <img alt="_images/3.png" src="http://cistrome.org/~qqin/3.png" height="500" width="650">
  </div>
  <div align="center">Figure 3. demo for LISA ranking of TF comparison directly from TF ChIP-seq peak</div>

  <div class="figure1" align="center">
  <img alt="_images/4.png" src="http://cistrome.org/~qqin/4.png" height="300" width="650">
  </div>
  <div align="center">Figure 4. LISA TF ranking based on TF-ChIP-seq in silico knockout method</div>

  <div class="figure1" align="center">
  <img alt="_images/5.png" src="http://cistrome.org/~qqin/5.png" height="300" width="650">
  </div>
  <div align="center">Figure 5. LISA TF ranking based on TF-ChIP-seq peak method</div>

  <div class="figure1" align="center">
  <img alt="_images/7.png" src="http://cistrome.org/~qqin/7.png" height="310" width="650">
  </div>
  <div align="center">Figure 6. Selected chromatin profile, model performance, and demo for link to CistromeDB</div>

  <div class="figure1" align="center">
  <img alt="_images/6.png" src="http://cistrome.org/~qqin/6.png" height="400" width="650">
  </div>
  <div align="center">Figure 7. TF ranking based on chromatin profile knockout of motif hit site</div>

   <div class="figure1" align="center">
   <img alt="_images/8.png" src="http://cistrome.org/~qqin/8.png" height="400" width="650">
   </div>
   <div align="center">Figure 8. gene set enrichment view mode on Wash U genome browser</div>

   <h4 id="item-2">Local command version</h4>
   <h4 id="item-2-1">Local installation</h4>
   <p class="just">LISA can be deployed as a command line version, which is installed using the following commands. </p>
   <code>
   <pre>
   wget -c https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
   bash Miniconda3-latest-Linux-x86_64.sh
   
   export PATH="${HOME}/miniconda3/bin:$PATH"
   conda install anaconda-client
   
   conda create -n lisa_impute anaconda python=3
   source activate lisa_impute
   
   conda config --add channels defaults
   conda config --add channels conda-forge
   conda config --add channels bioconda
   conda install blas mkl-service
   conda install -c anaconda openssl
   conda install -c anaconda curl 
   
   # this is for curl and openssl header files 
   export C_INCLUDE_PATH=${C_INCLUDE_PATH}:/usr/include/:${HOME}/.local/include:${HOME}/miniconda3/envs/lisa_impute/include
   
   pip install deeptools
   pip install fire
   pip install psutil
   pip install numpy
   pip install scipy
   pip install sklearn
   pip install theano
   
   git clone https://github.com/qinqian/lisa
   cd lisa
   conda env update -n lisa_impute -f environment.yml
   </pre>
   </code>
   </hr>

   <p class="just">To run local version, user needs to download the pre-computed and annotation files, and fill in the <cite>lisa/lisa.ini</cite> file with downloaded file path. The download links would be released after the accept of the manuscript. At last, the installatin would be done with:</p>
   <code>
   <pre>
   python setup.py install --user
   </pre>
   </code>

   <h4 id="item-2-2">Local usage</h4>
    <p class="just">The LISA framework has three pipeline represented with three sub-parsers, <cite>model</cite>, <cite>multiple_fastq2bigwig</cite>, and <cite>multiple_bigwig2hdf</cite>;
    The TF rank method is run through the <cite>model</cite> sub-parser.</p>
    <h6>Run all the methods</h6>
    <td class="code"><div class="highlight"><pre>lisa model --method<span class="o">=</span><span class="s1">'all'</span> --web<span class="o">=</span>False <span class="se">\</span>
               --new_rp_h5<span class="o">=</span>None --new_count_h5<span class="o">=</span>None <span class="se">\</span>
               --species hg38 --epigenome <span class="s2">"['H3K27ac', 'DNase']"</span> <span class="se">\</span>
               --cluster<span class="o">=</span>True --covariates<span class="o">=</span>False <span class="se">\</span>
               --random<span class="o">=</span>True <span class="se">\</span>
               --background<span class="o">=</span>None <span class="se">\</span> ## option for user the specify background genes
               --prefix test_function1 <span class="se">\</span>
               --threads <span class="m">8</span> test.gene_symbol
    </pre>
    </td></tr></tbody></table>
    <p>Options:
    The <cite>test.gene_symbol</cite> is the gene set user input, which is a text file with one official gene symbol or refseq id per line, mixture of the both is not supported yet, this is used as a prefix for output, so put the file in a directory with written permission.</p>
    <p>-–epigenome option controls the histone mark, DNase-seq or both to use in the features.</p>
    <p>--background option can specify user provided text file containing one gene a row to compare with the target gene set, --background=None to use random selected 3000 genes.</p>
    <h6>Run only one method</h6></h3>
    <p>run only the knockout or beta (direct from TF ChIP-seq) method:
    --method option can control the method to run knockout or beta method, use it with the option –web=True to turn off the baseline method.</p>

    </td><td class="code"><div class="highlight"><pre>lisa model --method<span class="o">=</span><span class="s1">'knockout'</span> <span class="se">\</span>
               --web<span class="o">=</span>True --new_rp_h5<span class="o">=</span>None <span class="se">\</span>
               --new_count_h5<span class="o">=</span>None --species hg38 <span class="se">\</span>
               --epigenome <span class="s2">"['H3K27ac']"</span> <span class="se">\</span>
               --cluster<span class="o">=</span>False --covariates<span class="o">=</span>False <span class="se">\</span>
               --random<span class="o">=</span>True <span class="se">\</span>
               --background<span class="o">=</span>None <span class="se">\</span> ## option for user the specify background genes
               --prefix test_function1 --threads <span class="m">8</span> test.gene_symbol
    
    lisa model --method<span class="o">=</span><span class="s1">'beta'</span> <span class="se">\</span>
               --web<span class="o">=</span>True <span class="se">\</span>
               --new_rp_h5<span class="o">=</span>None --new_count_h5<span class="o">=</span>None <span class="se">\</span>
               --species hg38 --epigenome <span class="s2">"['H3K27ac']"</span> <span class="se">\</span>
               --cluster<span class="o">=</span>False --covariates<span class="o">=</span>False <span class="se">\</span>
               --random<span class="o">=</span>True <span class="se">\</span>
               --background<span class="o">=</span>None <span class="se">\</span> ## option for user the specify background genes
               --prefix test_function1 --threads <span class="m">8</span> test.gene_symbol
    </pre>
    </td></tr></tbody></table>
    
    <p>run only the cluster method to rank</p>
    </td><td class="code"><div class="highlight"><pre>lisa model --method<span class="o">=</span><span class="s1">'none'</span> <span class="se">\</span>
               --web<span class="o">=</span>True --new_rp_h5<span class="o">=</span>None <span class="se">\</span>
               --new_count_h5<span class="o">=</span>None --species hg38 <span class="se">\</span>
               --epigenome <span class="s2">"['H3K27ac']"</span> --cluster<span class="o">=</span>True <span class="se">\</span>
               --background<span class="o">=</span>None <span class="se">\</span> ## option for user the specify background genes
               --covariates<span class="o">=</span>False --random<span class="o">=</span>True <span class="se">\</span>
               --prefix test_function1 --threads <span class="m">8</span> test.gene_symbol
    </pre>
    </td></tr></tbody></table>

    <h6 id="item-2-3">Local Output</h6>
    <p>Take <em>AR.symbol</em> input and histone mark <em>H3K27ac</em> as an example. By using the above command, the key results are as follows,</p>
    <table border="0" class="table">
    <colgroup>
    <col width="26%">
    <col width="37%">
    <col width="36%">
    </colgroup>
    <thead valign="bottom">
    <tr class="row-odd"><th class="head">Output File</th>
    <th class="head">Content</th>
    <th class="head">Instruction</th>
    </tr>
    </thead>
    <tbody valign="top">
    <tr class="row-even"><td>AR.symbol.premodel_records.txt</td>
    <td>regulatory potential cluster-based regression performance and coefficients</td>
    <td>one row is PRAUC,AUC,lambda, 2nd row is coefficients</td>
    </tr>
    <tr class="row-odd"><td>AR.symbol_motif99_baseline.csv</td>
    <td>baseline method based on motif hit between differential &amp; control gene</td>
    <td>one row is motif_id|TF_name,p-value</td>
    </tr>
    <tr class="row-even"><td>AR.symbol_chipseq_baseline.csv</td>
    <td>baseline method based on chip-seq peak hit between differential &amp; control gene</td>
    <td>one row is CistromeID|TF_name,p-value</td>
    </tr>
    <tr class="row-odd"><td>AR.symbol.gene_symbol.H3K27ac.coefs.csv</td>
    <td>Regression coefficients for H3K27ac</td>
    <td>one row is CistromeID,coefficient,cell type, cell line, tissue</td>
    </tr>
    <tr class="row-even"><td>AR.symbol.H3K27ac.lisa_predicted_rp.csv</td>
    <td>predicted differential expression log probability</td>
    <td>one row is refseq,log probability</td>
    </tr>
    <tr class="row-odd"><td>AR.symbol.H3K27ac.gene_set.performance</td>
    <td>differential gene prediction</td>
    <td>one row is AUC,PRAUC</td>
    </tr>
    <tr class="row-even"><td>AR.symbol.lisa_direct.csv</td>
    <td>BETA TF ranks based on random background or epigenetic background</td>
    <td>one row is CistromeID|TF_name,p_value</td>
    </tr>
    <tr class="row-odd"><td>AR.symbol.gene_symbol.H3K27ac.motif99.p_value.csv</td>
    <td>motif insilco knockout result for H3K27ac</td>
    <td>one row is motif_id|TF_name,p-value</td>
    </tr>
    <tr class="row-even"><td>AR.symbol.H3K27ac.chipseq.p_value.csv</td>
    <td>TF ChIP-seq insilco knockout result for H3K27ac</td>
    <td>one row is motif_id|TF_name,p-value</td>
    </tr>
    <tr class="row-odd"><td>AR.symbol.gene_symbol.H3K27ac.motif99.entropy_rank.csv</td>
    <td>motif-based TF ranks from KL divergence method</td>
    <td>one row is  motif_id|TF_name,KLD,rank</td>
    </tr>
    <tr class="row-even"><td>AR.symbol.gene_symbol.H3K27ac.chipseq.entropy_rank.csv</td>
    <td>ChIP-seq-based TF ranks from KL divergence method</td>
    <td>one row is motif_id|TF_name,KLD,rank|</td>
    </tr>
    </tbody>
    </table>

    <h4 id="item-3">FAQ</h4>
    <h6>How many datasets are there?</h6>
    <p>The 1st version of CistromeDB is incorporated, the dataset statistics is as the table below, NOTE: the data used for current LISA online is updated to CistromeDB (201801). </p>
    <div align="center">Table 1. Chromatin profile data and TF/CR ChIP-seq dataset</div>
    <table border="0" class="table">
    <colgroup>
    <col width="34%">
    <col width="34%">
    <col width="31%">
    </colgroup>
    <thead valign="bottom">
    <tr class="row-odd"><th class="head">Category</th>
    <th class="head">Human</th>
    <th class="head">Mouse</th>
    </tr>
    </thead>
    <tbody valign="top">
    <tr class="row-even"><td>DNase-seq</td>
    <td>1,110</td>
    <td>359</td>
    </tr>
    <tr class="row-odd"><td>H3K27ac ChIP-seq</td>
    <td>1,545</td>
    <td>1,031</td>
    </tr>
    <!--
    <tr class="row-even"><td>H3K27me3</td>
    <td>842</td>
    <td>932</td>
    </tr>
    <tr class="row-odd"><td>H3K4me3</td>
    <td>1,432</td>
    <td>1,032</td>
    </tr>
    <tr class="row-even"><td>H3K4me1</td>
    <td>726</td>
    <td>590</td>
    </tr>
    -->
    <tr class="row-odd"><td>TF and CR ChIP-seq</td>
    <td>6,773</td>
    <td>4,363</td>
    </tr>
    <!--
    <tr class="row-even"><td>Total</td>
    <td>12,428</td>
    <td>8,307</td>
    </tr>
    -->
    </tbody>
    </table>

    <hr>
  </div>
</div>

<nav class="navbar fixed-bottom navbar-dark">
  <div class="container">
    <a href="/" class="navbar-brand">
      <img src="http://liulab.dfci.harvard.edu/WEBSITE/images/Global/logofinal.png" height="46" width="58">
    </a>
    <ul class="navbar-nav bd-navbar-nav flex-row">
    <li class="nav-item active">
     <span>Copyright @2018 Liu lab</span>
    </li>
    </ul>
  </div>
</nav>
{% endblock %}


{% block scripts %}
<!-- {{ super() }} -->
<!-- <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> -->
<!-- <script src="{{ url_for('.static', filename='jquery-3.2.1.min.js') }}"></script> -->
<!-- <script src="{{ url_for('.static', filename='popper.min.js') }}"></script> -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>

<!-- <script src="http://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script> -->
<!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script> -->
<script src="{{ url_for('.static', filename='lisa.js') }}" type="text/javascript"></script>
<!--<script>
$('#spyOnThis').scrollspy();
</script>
-->
{% endblock %}
